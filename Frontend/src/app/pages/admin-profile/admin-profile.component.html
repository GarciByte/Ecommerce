<!-- NAV BAR -->
<app-nav></app-nav>

<!-- FIRST BLOCK WITH IMAGE AND SLOGAN -->
<div class="panel-top h-24rem d-flex w-full">
    <p class="m-auto text-white line-height-4 text-6xl uppercase font-bold">
        - MI PERFIL (ADMINISTRADOR) -
    </p>
</div>

<!-- User Admin Info -->
<div class="profile-info mt-4 m-auto">
    <div class="profile-row">
        <div class="profile-label">Nombre:</div>
        <div class="profile-input">
            <input type="text" [value]="user?.name" [readonly]="!isEditing">
        </div>
    </div>
    <div class="profile-row">
        <div class="profile-label">Correo:</div>
        <div class="profile-input">
            <input type="text" [value]="user?.email" [readonly]="!isEditing">
        </div>
    </div>
    <div class="profile-row">
        <div class="profile-label">Rol:</div>
        <div class="profile-input">
            <input type="text" [value]="user?.role" [readonly]="!isEditing">
        </div>
    </div>
    <div class="profile-row">
        <div class="profile-label">Dirección:</div>
        <div class="profile-input">
            <input type="text" [value]="user?.address" [readonly]="!isEditing">
        </div>
    </div>
    <div class="profile-row">
        <div class="profile-label">Contraseña:</div>
        <div class="profile-input">
            <input type="password" [value]="123456" [readonly]="!isEditing">
        </div>
    </div>
</div>


<div class="container d-flex justify-content-between">

    <div class="user-list">
        <h3 class="list-title">Lista de usuarios</h3>
        <table>
            <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Email</th>
                <th>Rol</th>
                <th>Acción</th>
            </tr>
            @for (user of users; track $index) {
            <tr>
                <td>{{user.userId}}</td>
                <td>{{user.name}}</td>
                <td>{{user.email}}</td>
                <td>
                    <select name="Rol" id={{user.role}} [(ngModel)]="user.role">
                        <option value="Admin">Admin</option>
                        <option value="User">User</option>
                    </select>
                </td>
                <td><button class="edit-btn" (click)="modifyUserRole(user.userId)">✎Actualizar</button> | <button class="edit-btn" (click)="deleteUser(user.userId)">Eliminar</button></td>
            </tr>
            }
        </table>
    </div>

    <div id="newProduct">
        <div id="formularioNuevoProducto">
            <h3 class="new-product-title">Crear nuevo producto</h3>
            <form (ngSubmit)="insertProduct()"> <br>
                <input type="text" name="productName" placeholder="Nombre" [(ngModel)]="insertProductName"/> <br><br>
                <input type="number" name="productPrice" placeholder="Precio" [(ngModel)]="insertProductPrice"/> <br><br>
                <input type="number" name="productStock" placeholder="Stock" [(ngModel)]="insertProductStock"/> <br><br>
                <input type="text" name="productDescription" placeholder="Descripción" [(ngModel)]="insertProductDescription"/> <br><br>
                
                <label for="productImage">Imagen: </label>
                <input type="file" name="productImage" placeholder="Ruta de la imagen" [(ngModel)]="insertProductImage"/> <br><br>
                <button (click)="insertProduct()">Crear producto</button>
            </form>
        </div>
    </div>

    <div class="product-list">
        <h3 class="list-title">
            Lista de productos 
            <button (click)="toggleInsertProduct()">Nuevo producto</button>
        </h3>
        <table>
            <tr>
                <th>ID</th>
                <th>Imagen</th>
                <th>Nombre</th>
                <th>Precio</th>
                <th>Stock</th>
                <th>Acción</th>
            </tr>
            @for (product of products; track $index) {
            <tr>
                <td>{{product.id}}</td>
                <td> <img [src]="IMG_URL + product.image"></td>
                <td>{{product.name}}</td>
                <td>{{product.price/100}}€</td>
                <td>{{product.stock}} uds.</td>
                <td><button class="edit-btn">✎Edit</button></td>
            </tr>
            }
        </table>
    </div>
    
    <div id="editProdcut">
        <div id="formularioEditarProducto">
            <h3 class="new-product-title">Editar producto</h3>
            <form (ngSubmit)="insertProduct()"> <br>
                <input type="text" name="productName" placeholder="Nuevo nombre" [(ngModel)]="insertProductName" /> <br><br>
                <input type="number" name="productPrice" placeholder="Nuevo precio" [(ngModel)]="insertProductPrice" />
                <br><br>
                <input type="number" name="productStock" placeholder="Nuevo stock" [(ngModel)]="insertProductStock" />
                <br><br>
                <input type="text" name="productDescription" placeholder="Nueva descripción"
                    [(ngModel)]="insertProductDescription" /> <br><br>
                <input type="file" accept="image/png, image/jpeg, image/jpg" name="productImage"
                    [(ngModel)]="insertProductImage" /> <br><br>
                <button (click)="insertProduct()">Confirmar cambios</button>
            </form>
        </div>
    </div>
</div>

<app-footer></app-footer>