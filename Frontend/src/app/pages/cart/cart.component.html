<app-nav></app-nav>

<!-- FIRST BLOCK WITH IMAGE AND SLOGAN -->
<div class="panel-top h-12rem d-flex w-full">
  <p class="m-auto text-white line-height-4 text-6xl uppercase font-bold">
    - cesta -
  </p>
</div>

<div class="cart-container">
  <div class="cart-content">

    <!-- SI EL USUARIO ESTA LOGUEADO -->
    @if(this.isLog){
      @if (cart.products.length === 0) {
      <div class="empty-cart">
        <p>Tu carrito está vacío.</p>
      </div>
      }
      <div *ngFor="let productLine of cart.products">
        <div class="cart-product">
          <img src="{{ IMG_URL }}{{ productLine.product.image }}" />
          <div class="product-details">
            <h3>{{ productLine.product.name }}</h3>
            <p>{{ productLine.product.price / 100 }} €</p>

            <label>Cantidad: </label>
            <input type="number" class="input-quantity" [(ngModel)]="productLine.quantity"
              (ngModelChange)="changeQuantityBBDD(productLine, productLine.quantity)" min="1" />

            <button class="p-button-danger" label="Eliminar" (click)="removeProductBBDD(productLine.productId)">
              Eliminar
            </button>

          </div>
        </div>
      </div>
    }

    <!-- SI EL USUARIO NO ESTA LOGUEADO -->
    @if(!isLog) {
      @if (cartProducts.length === 0) {
      <div class="empty-cart">
        <p>Tu carrito está vacío.</p>
      </div>
      }
      @for (product of cartProducts; track product.productId) {
      <div class="cart-product">
        <img src="{{ IMG_URL }}{{ product.product.image }}" />
        <div class="product-details">
          <h3>{{ product.product.name }}</h3>
          <p>{{ product.product.price / 100 }} €</p>

          <label>Cantidad: </label>
          <input type="number" class="input-quantity" [(ngModel)]="product.quantity"
            (ngModelChange)="changeQuantityLocal(product, product.quantity)" min="1" />

          <button class="p-button-danger" label="Eliminar" (click)="removeProductLocal(product)">
            Eliminar
          </button>

      </div>
    </div>
    }

    }
    <div class="cart-total">
      <p>Total: {{ total | currency : "EUR" }}</p>
    </div>
    <div class="pay-button">
      <button>
        Pagar con ethereum
      </button>
      <button>
        Pagar con tarjeta
      </button>
    </div>

  </div>
</div>
<!-- FOOTER -->
<app-footer></app-footer>